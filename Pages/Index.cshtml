@page
@model IndexModel
@{
    ViewData["Title"] = "Collatz Conjecture";
}
<h3>
    This page is a work in progress. To see the source, check out the <a href="https://github.com/VincentSaelzler/CollatzConjecture">Project on Github</a>
</h3>
<h3>
    For more on Collatz Conjecture, check out this <a href="https://www.youtube.com/watch?v=5mFpVDpKX70">Numberphile Video</a>
</h3>
<form method="post">
    <p>
        <!-- form elemnts to save state of form -->
        <input  id="@Html.IdFor(m => m.SortOrder)" name="@Html.NameFor(m => m.SortOrder)" value="@Model.SortOrder" type="hidden" />
        <input  id="@Html.IdFor(m => m.PageNum)" name="@Html.NameFor(m => m.PageNum)" value="@Model.PageNum" type="hidden" />
        <!-- form elemnts to collect input -->
        Even Expression: <input asp-for="EvenExp" />
        Odd Expression: <input asp-for="OddExp" />
        <input type="submit" value="Conject" asp-page-handler=""/>
    </p>
<table class="table">
    <tr>
        <th>
            <input type="submit" asp-page-handler="SortInitVal" value="Initial Value" />
        </th>
        <th>
            <input type="submit" asp-page-handler="SortStopTime" value="Total Stopping Time" />
        </th>
        <th>
            Steps Graph
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model.Sequences)
    {
        <tr>
            <td>
                <!-- todo: modelitem or i? -->
                @Html.DisplayFor(modelItem => item.InitialValue)
            </td>
            <td>
                @*@Html.DisplayFor(modelItem => item.Steps.Count()) - threw a run time error - both .Count() and .Count threw errors)*@
                @Html.DisplayFor(modelItem => item.TotalStoppingTime)
            </td>
            <td>
                <canvas id="myChart@(item.InitialValue)" width="100" height="100"></canvas>
                <script>
                    var ctx = document.getElementById("myChart@(item.InitialValue)");
                    var myChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: [ @item.LegendString],
                            datasets: [{
                                label: 'Collatz Series',
                                data: [ @item.StepsString],
                            }]
                        },
                        options: {
                            maintainAspectRatio: false,
                            legend: {
                                display: false
                            },
                            tooltips: {
                                //enabled: false
                            }
                        }
                    });
                </script>
            </td>
            @*UNDONE: Show drill down details on number
                <td>
                    @Html.ActionLink("Details", "Details", new { id = item.StartingNumberId }) |
                </td>*@
        </tr>
    }
</table>

</form>
Page @(Model.Sequences.PageCount < Model.Sequences.PageNumber ? 0 : Model.Sequences.PageNumber) of @Model.Sequences.PageCount
